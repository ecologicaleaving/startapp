# Story 3.1: Assignment-First Dashboard Redesign

## Status
Draft

## Story
**As a tournament referee,**  
**I need my current assignment prominently displayed on the dashboard with countdown and context,**  
**So that I can immediately understand my next responsibilities when opening the app.**

## Acceptance Criteria
1. Dashboard redesigned with current assignment as primary focal point:
   - **Current Assignment Card:** Prominently positioned at top of screen with high-visibility styling
   - **Countdown Timer:** Real-time countdown to assignment start time with color-coded urgency
   - **Assignment Context:** Court number, teams, match importance displayed clearly
   - **Quick Actions:** Direct access to assignment details and result entry
2. Assignment status integrated throughout dashboard with visual hierarchy:
   - **Upcoming Assignments:** Secondary visual treatment showing next 2-3 assignments
   - **Assignment Timeline:** Visual timeline showing referee's daily schedule
   - **Status Indicators:** Clear visual coding for assignment states across dashboard
3. Dashboard responsive design optimized for quick glance interactions
4. Real-time dashboard updates for assignment changes and time progression
5. Emergency information and contacts readily accessible from dashboard

## Tasks / Subtasks
- [ ] **Task 1: Current Assignment Card Redesign** (AC: 1)
  - [ ] Replace generic tournament card with prominently positioned current assignment card
  - [ ] Implement high-visibility styling using Epic 1 design tokens with maximum contrast
  - [ ] Create assignment context display showing court number, teams, and match importance
  - [ ] Add direct action buttons for assignment details and result entry navigation
  - [ ] Integrate touch target compliance from Story 2.5 (44px minimum for all interactive elements)
  
- [ ] **Task 2: Real-time Countdown Timer System** (AC: 1, 2)
  - [ ] Implement real-time countdown timer with background updates and time progression
  - [ ] Create color-coded urgency system using status colors from design tokens
  - [ ] Build countdown display with appropriate time formatting (hours, minutes for different ranges)
  - [ ] Add countdown animation states and visual feedback for time-critical periods
  - [ ] Integrate with assignment data to calculate accurate countdown times
  
- [ ] **Task 3: Assignment Status Visual Hierarchy** (AC: 2)
  - [ ] Replace generic dashboard grid with assignment-focused information architecture
  - [ ] Implement upcoming assignments display with secondary visual treatment (next 2-3 assignments)
  - [ ] Create visual timeline component showing referee's daily assignment schedule
  - [ ] Integrate status indicators from Story 2.4 throughout dashboard layout
  - [ ] Establish clear visual hierarchy prioritizing assignment-related information
  
- [ ] **Task 4: Dashboard Responsive Optimization** (AC: 3)
  - [ ] Optimize dashboard layout for quick glance mobile interactions
  - [ ] Implement responsive design patterns for different device orientations
  - [ ] Ensure proper touch targets and spacing using Story 2.5 touch target system
  - [ ] Create dashboard scroll behavior optimized for single-handed referee operation
  - [ ] Test dashboard readability in outdoor sunlight conditions
  
- [ ] **Task 5: Real-time Updates & Emergency Access** (AC: 4, 5)
  - [ ] Build real-time dashboard update system for assignment changes
  - [ ] Implement assignment data refresh with visual feedback for data staleness
  - [ ] Create emergency information section with always-accessible tournament contacts
  - [ ] Add assignment change notifications with appropriate visual and haptic feedback
  - [ ] Build offline dashboard state with cached assignment data display

## Dev Notes

### Previous Story Insights
From Story 2.5 (Outdoor-Optimized Touch Target System) completion notes:
- **Touch Target Compliance**: 44px minimum touch targets established across component library - apply to all dashboard interactive elements
- **TouchFeedbackProvider Integration**: Comprehensive haptic, visual, and audio feedback system available - leverage for assignment card interactions
- **Component Performance**: React.memo optimization patterns and StyleSheet.create performance proven effective - apply to dashboard component architecture
- **Design Token Integration**: Seamless integration with Epic 1 design tokens established - maintain consistency in dashboard redesign

From Story 2.4 (Professional Status Indicator System) completion notes:
- **Status Indicator System**: Comprehensive status indicators available with assignment states (current, upcoming, completed, cancelled) - integrate throughout dashboard
- **Visual Hierarchy**: Status-driven visual coding established with WCAG AAA compliance - extend to assignment prominence system
- **Real-time Updates**: Status animation system with smooth transitions proven effective - leverage for assignment countdown and status changes

From Story 2.3 (Tournament Info Panel System) completion notes:
- **Information Architecture**: Hierarchical information display patterns established - adapt for assignment-first dashboard layout
- **Responsive Layout**: Adaptive density calculation and responsive design patterns proven effective - apply to dashboard optimization
- **Context Integration**: Tournament context data integration established - leverage for assignment context display

### Technical Context & Stack
**React Native/Expo Application Setup**:
- React Native 0.79.5 with React 19.0.0 [Source: CLAUDE.md]
- Expo SDK ~53.0.20 with expo-router for navigation [Source: CLAUDE.md]  
- TypeScript configuration already in place [Source: CLAUDE.md]
- Testing with Jest ~29.7.0 and @testing-library/react-native [Source: previous story testing]
- ESLint with Expo config for code quality [Source: CLAUDE.md]

**Epic 1 & Story 2.x Foundation Available**:
- Design token system established in `theme/tokens.ts` with WCAG AAA compliance [Source: theme/tokens.ts]
- Status color coding system with 7:1 contrast ratios for outdoor visibility [Source: theme/tokens.ts]
- Assignment Card component family from Story 2.1 available for integration [Source: Story 2.1 implementation]
- Touch target compliance system from Story 2.5 available [Source: Story 2.5 implementation]
- Status indicator system from Story 2.4 available [Source: Story 2.4 implementation]

### Assignment-First Dashboard Architecture
**Source: [docs/epics/epic-003-referee-screen-architecture.md#user-story-1]**

**Current Assignment Prominence Requirements**:
- **Primary Focal Point**: Current assignment prominently positioned at top of screen replacing generic tournament information
- **High-Visibility Styling**: Maximum contrast design using Epic 1 design tokens with status-driven color coding
- **Countdown Integration**: Real-time countdown to assignment start time with color-coded urgency indicators
- **Assignment Context**: Court number, teams, match importance, and referee position clearly displayed
- **Quick Actions**: Direct access to assignment details and result entry workflows

**Dashboard Information Hierarchy Requirements**:
- **Primary Information**: Current assignment, countdown timer, assignment context (prominently displayed)
- **Secondary Information**: Upcoming assignments (next 2-3), assignment timeline, status indicators
- **Tertiary Information**: Tournament context, emergency contacts, general dashboard actions
- **Visual Hierarchy**: Clear separation between assignment-related and general tournament information

### Real-time Assignment System Architecture
**Source: [Current RefereeDashboardScreen.tsx implementation and Epic 003 requirements]**

**Assignment Data Integration Requirements**:
- **Current Assignment Detection**: Identify referee's current assignment from assignment data
- **Real-time Updates**: Assignment changes reflected in dashboard within 2 seconds
- **Countdown Calculation**: Accurate countdown to assignment start time with time zone handling
- **Status Synchronization**: Assignment status changes propagated across dashboard components
- **Offline Capability**: Cached assignment data available for offline dashboard functionality

**Countdown Timer System Requirements**:
- **Background Updates**: Countdown continues updating even when app is backgrounded
- **Urgency Indicators**: Color-coded urgency system (green: >1 hour, yellow: 15-60 min, red: <15 min)
- **Time Formatting**: Appropriate time display (hours/minutes for long periods, minutes/seconds for immediate)
- **Animation States**: Smooth countdown transitions with visual feedback for critical time periods
- **Performance Optimization**: Efficient timer implementation without excessive re-renders

### File Locations & Project Structure
**Source: [CLAUDE.md and previous story implementation patterns]**

**Files to Modify**:
- Dashboard screen: `screens/RefereeDashboardScreen.tsx` - Complete dashboard redesign with assignment-first architecture
- Main app entry: `app/index.tsx` - Integration with new dashboard architecture
- Dashboard navigation: `app/referee-dashboard.tsx` - Navigation integration with assignment data

**Files to Create**:
- Assignment dashboard hooks: `hooks/useCurrentAssignment.ts`, `hooks/useAssignmentCountdown.ts`
- Dashboard components: `components/Dashboard/CurrentAssignmentCard.tsx`, `components/Dashboard/AssignmentTimeline.tsx`, `components/Dashboard/CountdownTimer.tsx`
- Dashboard utilities: `utils/assignmentDashboard.ts` - Assignment detection and dashboard optimization utilities
- Dashboard tests: `__tests__/screens/RefereeDashboardScreen.test.tsx`, `__tests__/hooks/useCurrentAssignment.test.ts`

**Files to Reference**:
- Design tokens: `theme/tokens.ts` - Status colors, typography, spacing for assignment prominence
- Assignment cards: `components/Assignment/AssignmentCard.tsx` - Integration with existing assignment card system
- Status indicators: `components/Status/StatusIndicator.tsx` - Dashboard status indicator integration
- Touch target system: `components/TouchTarget/` - Touch target compliance for dashboard interactions

### Technical Constraints & Standards
**Source: [CLAUDE.md and Epic 003 requirements]**

**React Native Dashboard Approach**:
- Leverage existing component architecture from Stories 2.1-2.5 for consistency
- Follow established component memoization and performance optimization patterns
- Maintain design token integration for outdoor visibility compliance
- Path aliases using `@/*` mapping to root directory [Source: CLAUDE.md]

**Dashboard Performance Requirements**:
- **Screen Transition**: <500ms transition time for dashboard loading and navigation
- **Real-time Updates**: Assignment changes reflected within 2 seconds
- **Countdown Performance**: Efficient timer updates without excessive re-renders
- **Touch Response**: <16ms touch response for 60fps performance on assignment card interactions

**Assignment Recognition Requirements**:
- **Recognition Speed**: <3 seconds for referee current assignment identification upon app launch
- **Visual Prominence**: Current assignment immediately visible without scrolling
- **Context Clarity**: Assignment context (court, teams, time) clear at first glance
- **Status Visibility**: Assignment status indicators visible across dashboard layout

## Testing

### Testing Standards
**Test Framework**: Jest ~29.7.0 with @testing-library/react-native ~13.2.2 [Source: previous story testing setup]

**Test File Locations**:
- Dashboard screen tests: `__tests__/screens/RefereeDashboardScreen.test.tsx`
- Assignment hooks tests: `__tests__/hooks/useCurrentAssignment.test.ts`, `__tests__/hooks/useAssignmentCountdown.test.ts`
- Dashboard component tests: `__tests__/components/Dashboard/`
- Integration tests: `__tests__/integration/` (dashboard integration with assignment data)

**Specific Testing Requirements for this Story**:
- Assignment-first layout rendering and information hierarchy validation
- Real-time countdown timer accuracy and performance testing
- Assignment data integration and real-time update testing
- Dashboard responsive design testing across device sizes and orientations
- Touch target compliance testing for all dashboard interactive elements
- Emergency access and contact information availability testing

**Test Coverage Requirements**:
- Dashboard screen component: 95% coverage
- Assignment detection and countdown utilities: 100% coverage
- Dashboard hooks (useCurrentAssignment, useAssignmentCountdown): 90% coverage
- Assignment card integration and status indicator integration: 85% coverage

**Integration with Existing Testing**:
- **EXTEND** existing component testing patterns from Stories 2.1-2.5
- **INTEGRATE** with Epic 1 accessibility and visual design testing standards
- **BUILD UPON** established assignment card and status indicator testing patterns

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-13 | 1.0 | Initial story creation for Epic 003 User Story 1 | Bob (SM) |

## Dev Agent Record

### Agent Model Used
[To be filled during implementation]

### Debug Log References  
[To be filled during implementation]

### Completion Notes List
[To be filled during implementation]

### File List
[To be filled during implementation]